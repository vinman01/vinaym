apiVersion: v1
kind: Pod
metadata:
  name: mc-pod
  namespace: mc-namespace
spec:
  containers:
    - name: mc-pod-1
      image: nginx:1-alpine
      env:
        - name: NODE_NAME
          valueFrom:
            fieldRef:
              fieldPath: spec.nodeName
    - name: mc-pod-2
      image: busybox:1
      volumeMounts:
        - name: shared-volume
          mountPath: /var/log/shared
      command:
        - "sh"
        - "-c"
        - "while true; do date >> /var/log/shared/date.log; sleep 1; done"
    - name: mc-pod-3
      image: busybox:1
      command:
        - "sh"
        - "-c"
        - "tail -f /var/log/shared/date.log"
      volumeMounts:
        - name: shared-volume
          mountPath: /var/log/shared
  volumes:
    - name: shared-volume
      emptyDir: {}

volumeMounts:
    - name: log-volume
      mountPath: /var/log/shared


sudo dpkg -i cri-docker_0.3.16.3-0.debian.deb


kubectl get crd -o custom-columns=NAME:.metadata.name | grep verticalpodautoscaler > /root/vpa-crds.txt


kubeadm init --pod-network-cidr=172.17.0.0/16--cri-socket=unix:///var/run/cri-dockerd.sock



ssh bob@node01

Switch to root using sudo -i or prefix the commands below using sudo.

The cri-docker_0.3.16.3-0.debian.deb package is located in the /root directory. Use dpkg to install the package:

dpkg -i /root/cri-docker_0.3.16.3-0.debian.deb

After installing the package, start the cri-docker service and enable it to start on boot:

systemctl start cri-docker
systemctl enable cri-docker

Verify that the cri-docker service is running:

systemctl is-active cri-docker

Check that it is enabled to start on boot:

systemctl is-enabled cri-docker


apiVersion: autoscaling.k8s.io/v1
kind: VerticalPodAutoscaler
metadata:
  name: analytics-vpa
  namespace: default
spec:
  targetRef:
    apiVersion: "apps/v1"
    kind: Deployment
    name: analytics-deployment
  updatePolicy:
    updateMode: "Auto"
  resourcePolicy:
    containerPolicies:
    - containerName: "kkapp-container"


under base Dir 
make new Dir overlay-prod/
controlplane /home/student/kustomize âžœ  cat overlay-prod/kustomization.yaml
resources:
- ../base

namePrefix: prod-
labels:
  - pairs:
      enviornment: production

images:
  name: nginx
  newTag: "1.21"